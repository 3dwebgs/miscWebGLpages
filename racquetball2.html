<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

        <title>RacketSmiley</title>
        <!-- Babylon.js -->
        <script src="http://www.babylonjs.com/hand.minified-1.2.js"></script>
        <script src="http://www.babylonjs.com/cannon.js"></script>
        <script src="http://www.babylonjs.com/oimo.js"></script>
        <script src="http://www.babylonjs.com/babylon.js"></script>
        <style>
            html, body {
                overflow: hidden;
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }

            #renderCanvas {
                width: 100%;
                height: 100%;
                touch-action: none;
            }
        </style>
    </head>
<body>
    <canvas id="renderCanvas"></canvas>
    <script>
	//http://www.babylonjs-playground.com/#14VWOV#4
	
		
        var canvas = document.getElementById("renderCanvas");
        var engine = new BABYLON.Engine(canvas, true);

        var createScene = function () {

			var scene = new BABYLON.Scene(engine);
			scene.clearColor = new BABYLON.Color3(0.13, 0.11, 0.15);
			
			var camera = new BABYLON.ArcRotateCamera("Camera", 0, 0, 0, new BABYLON.Vector3(0,50,0), scene);
			camera.setPosition(new BABYLON.Vector3(0, 70, 275));
			camera.lowerBetaLimit = 0.1;
			camera.upperBetaLimit = (Math.PI / 2) * 0.99;
			camera.lowerRadiusLimit = 150;
			camera.attachControl(canvas, true);

			//light
			var light0 = new BABYLON.HemisphericLight("Hemi0", new BABYLON.Vector3(0, 1, 0), scene);
			light0.diffuse = new BABYLON.Color3(1, 1, 1);
			light0.specular = new BABYLON.Color3(1, 1, 1);
			light0.groundColor = new BABYLON.Color3(.4, .4, .4);
			light0.intensity = 0.9;
			
			//Ground & wall planes
			var pi = Math.PI; //for rotation
			
			var ground = BABYLON.Mesh.CreateGround("ground", 200, 400, 1, scene, false);
			var groundMaterial = new BABYLON.StandardMaterial("wallMat", scene);
			groundMaterial.diffuseColor = new BABYLON.Color3(0.820, 0.753, 0.467);
			groundMaterial.specularColor = BABYLON.Color3.Black();
			ground.material = groundMaterial;
			
			var backWall = BABYLON.Mesh.CreatePlane("backWall", 200, scene);
			var backWallMaterial = new BABYLON.StandardMaterial("wallMat", scene);
			backWallMaterial.diffuseColor = new BABYLON.Color3(1, 1, 1);
			backWallMaterial.specularColor = BABYLON.Color3.Black();
			backWall.material = backWallMaterial;
			backWall.position.y = 100;
			backWall.position.z = -200;
			backWall.rotation = new BABYLON.Vector3(0, Math.PI, 0);
					
			var sideWallMaterial = new BABYLON.StandardMaterial("wallMat", scene);
			sideWallMaterial.diffuseColor = new BABYLON.Color3(0.900, 0.900, 0.900);
			sideWallMaterial.specularColor = BABYLON.Color3.Black();

			var leftWall = BABYLON.MeshBuilder.CreatePlane("leftWall", {width:400,height:200, sideOrientation: BABYLON.Mesh.DOUBLESIDE}, scene);
			leftWall.material = sideWallMaterial;
			leftWall.position = new BABYLON.Vector3(100, 100, 0);
			leftWall.rotation = new BABYLON.Vector3(0, pi/2, 0);

			var rightWall = BABYLON.MeshBuilder.CreatePlane("rightWall", {width:400,height:200, sideOrientation: BABYLON.Mesh.DOUBLESIDE}, scene);
			rightWall.material = sideWallMaterial;
			rightWall.position = new BABYLON.Vector3(-100, 100, 0);
			rightWall.rotation = new BABYLON.Vector3(0, pi/2, 0);
			
			var ceiling = BABYLON.MeshBuilder.CreatePlane("ceiling", {width:200,height:400, sideOrientation: BABYLON.Mesh.DOUBLESIDE}, scene);
			ceiling.material = sideWallMaterial;
			ceiling.position = new BABYLON.Vector3(0, 200, 0);
			ceiling.rotation.x = pi/2
			
			// ball
			var ball = BABYLON.Mesh.CreateSphere("ball", 16, 10, scene);
			var redMat = new BABYLON.StandardMaterial("ballMaterial", scene);
			redMat.diffuseColor = new BABYLON.Color3(0.4, 0.4, 0.4);
			redMat.specularColor = new BABYLON.Color3(0.4, 0.4, 0.4);
			redMat.emissiveColor = BABYLON.Color3.Red();
			ball.material = redMat;
			ball.position.y = 20;
			ball.position.x -= 0;
			
			// Enable Physics
			scene.enablePhysics(new BABYLON.Vector3(0,-9.81, 0), new BABYLON.OimoJSPlugin());
			
			ground.physicsImpostor = new BABYLON.PhysicsImpostor(
				ground, BABYLON.PhysicsImpostor.BoxImpostor, { mass: 0, restitution: 0.9 }, scene);
				
			backWall.physicsImpostor = new BABYLON.PhysicsImpostor(
				backWall, BABYLON.PhysicsImpostor.BoxImpostor, { mass: 0, restitution: 0.9 }, scene);
			
			leftWall.physicsImpostor = new BABYLON.PhysicsImpostor(
				leftWall, BABYLON.PhysicsImpostor.BoxImpostor, { mass: 0, restitution: 0.9 }, scene);
			
			rightWall.physicsImpostor = new BABYLON.PhysicsImpostor(
				rightWall, BABYLON.PhysicsImpostor.BoxImpostor, { mass: 0, restitution: 0.9 }, scene);
			
			ceiling.physicsImpostor = new BABYLON.PhysicsImpostor(
				ceiling, BABYLON.PhysicsImpostor.BoxImpostor, { mass: 0, restitution: 0.9 }, scene);
			
			ball.physicsImpostor = new BABYLON.PhysicsImpostor(
				ball, BABYLON.PhysicsImpostor.SphereImpostor, { mass: 1, restitution: 0.9 }, scene);
				
			ball.physicsImpostor.setLinearVelocity(new BABYLON.Vector3(1, 0, -2));	
			ball.physicsImpostor.applyImpulse(new BABYLON.Vector3(0.5, 6, 3), ball.getAbsolutePosition());
			 
			return scene;
        };
        
        var scene = createScene();

        engine.runRenderLoop(function () {
            scene.render();
        });

        // Resize
        window.addEventListener("resize", function () {
            engine.resize();
        });
    </script>
</body>
</html>
